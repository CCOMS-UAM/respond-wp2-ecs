
library(reprex)
library(tidyverse)


Importing data

#To get the data structure (just execute this command when having the original
#file)
# dput(data_2019 %>% 
#          slice_sample(prop = 0.30) %>% 
#        select(q0410g_total:q0410k_other), file = data_c2019w1)


data_c2019w1 <- structure(
  list(
    q0410g_total = structure(
      c(
        2,
        27,
        26,
        12,
        999,
        999,
        999,
        24,
        999,
        888,
        888,
        2,
        2,
        NA,
        1,
        888,
        888,
        999,
        12,
        888,
        1,
        22,
        999,
        26,
        2,
        999,
        1,
        888,
        26,
        999,
        3,
        888,
        18,
        25,
        888,
        999,
        2,
        999,
        28,
        24,
        999,
        2,
        17,
        1,
        1,
        1,
        888,
        21,
        23,
        1,
        20,
        888,
        999,
        999,
        999,
        999,
        21,
        20,
        888,
        888,
        4,
        999,
        1,
        999,
        4,
        17,
        25,
        1,
        24,
        23,
        29,
        1,
        27,
        25,
        999,
        999,
        999,
        2,
        888,
        25,
        24,
        999,
        13,
        1,
        1,
        999,
        999,
        1,
        999,
        888,
        999,
        17,
        2,
        NA,
        28,
        2,
        1,
        999,
        17,
        888,
        29,
        1,
        999,
        28,
        8,
        24,
        999,
        2,
        2,
        24,
        2,
        11,
        999,
        999,
        18,
        999,
        1,
        888,
        7,
        999,
        999,
        999,
        1,
        999,
        23,
        999,
        7,
        26,
        14,
        999,
        21,
        17,
        25,
        2,
        20,
        NA,
        15,
        888,
        999,
        26,
        2,
        999,
        1,
        1,
        27,
        11,
        23,
        15,
        999,
        NA,
        999,
        1,
        1,
        999,
        1,
        1,
        17,
        21,
        19,
        999,
        25,
        2,
        2,
        23,
        25,
        888,
        13,
        999,
        24,
        2,
        999,
        999,
        2,
        19,
        17,
        24,
        999,
        1,
        21,
        1,
        999,
        1,
        28,
        888,
        18,
        23,
        888,
        2,
        16,
        27,
        999,
        1,
        23,
        888,
        15,
        8,
        23,
        999,
        999,
        23,
        8,
        999,
        11,
        999,
        2,
        NA,
        NA,
        17,
        1,
        1,
        NA,
        999,
        888,
        999,
        888,
        2,
        25,
        999,
        4,
        888,
        23,
        24,
        999,
        9,
        2,
        23,
        22,
        999,
        888,
        999,
        11,
        2,
        17,
        16,
        8,
        2,
        2,
        20,
        888,
        20,
        999,
        888,
        2,
        14,
        4,
        999,
        2,
        999,
        23,
        28,
        888,
        888,
        16,
        999,
        999,
        888,
        27,
        NA,
        1,
        25,
        999,
        25,
        888,
        17,
        999,
        999,
        888,
        2,
        16,
        26,
        29,
        888,
        2,
        25,
        888,
        20,
        21,
        999,
        1,
        27,
        1,
        999,
        1,
        23,
        999,
        999,
        2,
        23,
        888,
        20,
        1,
        999,
        20,
        2,
        888,
        24,
        27,
        999,
        2,
        3,
        NA,
        888,
        2,
        2,
        16,
        999,
        11,
        2,
        20,
        888,
        1,
        25,
        1,
        2,
        3,
        1,
        999,
        27,
        999,
        2,
        999,
        25,
        888,
        888,
        2,
        2,
        15,
        999,
        2,
        999,
        23,
        30,
        999,
        999,
        19,
        7,
        24,
        NA,
        2,
        NA,
        999,
        888,
        16,
        888,
        19,
        999,
        2,
        24,
        2,
        18,
        888,
        2,
        999,
        999,
        23,
        888,
        888,
        888,
        1,
        23,
        999,
        26,
        999,
        888,
        1,
        1,
        999,
        21,
        1,
        999,
        20,
        888,
        999,
        1,
        1,
        888,
        27,
        2,
        888,
        2,
        29,
        24,
        17,
        1,
        14,
        1,
        1,
        999,
        2,
        2,
        999,
        999,
        999,
        2,
        999,
        2,
        2,
        17,
        2,
        888,
        4,
        12,
        888,
        21,
        23,
        25,
        999,
        20,
        2,
        23,
        15,
        1,
        2,
        999,
        17,
        24,
        2,
        25,
        2,
        999,
        999,
        27,
        999,
        888,
        888,
        1,
        27,
        23,
        999,
        NA,
        25,
        21,
        888,
        15,
        999,
        999,
        NA,
        888,
        2,
        999,
        999,
        1,
        888,
        1,
        1,
        24,
        888,
        2,
        2,
        999,
        3,
        999,
        999,
        999,
        2,
        13,
        1,
        999,
        999,
        21,
        999,
        999,
        999,
        999,
        23,
        2,
        2,
        15,
        999,
        999,
        22,
        22,
        29,
        999,
        999,
        2,
        NA,
        18,
        999,
        999,
        999,
        999,
        12,
        888,
        24,
        888,
        999,
        1,
        888,
        1,
        999,
        999,
        15,
        2,
        999,
        999,
        1,
        999,
        999,
        999,
        17,
        2,
        1,
        2,
        NA,
        888,
        1,
        23,
        2,
        2,
        999,
        999,
        999,
        999,
        NA,
        888,
        25,
        999,
        999,
        NA,
        1,
        999,
        NA,
        999,
        999,
        25,
        888,
        24,
        24,
        23,
        26,
        888,
        16,
        999,
        1,
        2,
        2,
        999,
        21,
        1,
        999,
        999,
        27,
        999,
        999,
        28,
        NA,
        18,
        888,
        2,
        23,
        26,
        999,
        24,
        999,
        24,
        888,
        23,
        NA,
        8,
        26,
        23,
        4,
        21,
        1,
        999,
        999,
        15,
        888,
        1,
        1,
        888,
        2,
        2,
        29,
        999,
        21,
        25,
        15,
        999,
        20,
        22,
        23,
        15,
        17,
        888,
        1,
        999,
        888,
        23,
        999,
        1,
        888,
        999,
        25,
        22,
        2,
        23,
        888,
        888,
        999,
        17,
        999,
        23,
        1,
        999,
        888,
        888,
        999,
        2,
        2,
        25,
        16,
        23,
        23,
        999,
        29,
        17,
        888,
        4,
        14,
        27,
        1,
        999,
        999,
        1,
        1,
        2,
        24,
        999,
        999,
        999,
        999,
        2,
        999,
        28,
        999,
        2,
        23,
        999,
        14,
        1,
        16,
        2,
        16,
        2,
        888,
        2,
        18,
        1,
        2,
        1,
        2,
        1,
        999,
        999,
        23,
        999,
        888,
        NA,
        888,
        21,
        2,
        999,
        20,
        20,
        888,
        999,
        999,
        32,
        888,
        2,
        999,
        23,
        1,
        13,
        23,
        999,
        25,
        18,
        2,
        999,
        999,
        999,
        NA,
        25,
        888,
        1,
        999,
        999,
        15,
        15,
        1,
        24,
        999,
        2,
        888,
        24,
        999,
        NA,
        999,
        17,
        999,
        1,
        12,
        17,
        999,
        999,
        4,
        1,
        888,
        888,
        888,
        1,
        888,
        999,
        888,
        999,
        999,
        2,
        2,
        2,
        11,
        2,
        1,
        23,
        1,
        23,
        888,
        24,
        19,
        24,
        888,
        999,
        2,
        19,
        NA,
        2,
        18,
        999,
        999,
        888,
        888,
        2,
        2,
        22,
        2,
        16,
        999,
        999,
        11,
        25,
        1,
        2,
        2,
        NA,
        999,
        999,
        999,
        999,
        888,
        17,
        16,
        999,
        22,
        1,
        999,
        2,
        NA,
        18,
        999,
        2,
        999,
        27,
        1,
        30,
        999,
        9,
        999,
        999,
        2,
        999,
        2,
        24,
        24,
        999,
        1,
        999,
        999,
        8,
        2,
        26,
        23,
        27,
        999,
        999,
        999,
        1,
        18,
        888,
        2,
        999,
        2,
        2,
        25,
        999,
        25,
        888,
        999,
        3,
        888,
        999,
        15,
        4,
        25,
        999,
        999,
        888,
        NA,
        17,
        20,
        9,
        27,
        999,
        1,
        12,
        25,
        20,
        2,
        999,
        NA,
        999,
        NA,
        999,
        NA,
        999,
        2,
        888,
        24,
        27,
        2,
        999,
        999,
        2,
        1,
        999,
        10,
        1,
        17,
        27,
        3,
        23,
        2,
        2,
        22,
        2,
        999,
        23,
        999,
        999,
        25,
        21,
        18,
        999,
        29,
        888,
        999,
        2,
        19,
        2,
        2,
        22,
        888,
        NA,
        999,
        23,
        888,
        999,
        999,
        22,
        NA,
        25,
        4,
        16,
        26,
        888,
        1,
        18,
        15,
        999,
        2,
        23,
        2,
        888,
        888,
        888,
        999,
        888,
        999,
        999
      ),
      label = "total earnings",
      format.stata = "%10.0g",
      labels = c(
        a = 1,
        b = 2,
        c = 3,
        d = 4,
        e = 5,
        f = 6,
        g = 7,
        h = 8,
        i = 9,
        j = 10,
        k = 11,
        l = 12,
        m = 13,
        n = 14,
        o = 15,
        p = 16,
        q = 17,
        r = 18,
        s = 19,
        t = 20,
        u = 21,
        v = 22,
        w = 23,
        x = 24,
        y = 25,
        z = 26,
        aa = 27,
        bb = 28,
        cc = 29,
        dd = 30,
        ee = 31,
        ff = 32,
        gg = 33,
        hh = 34,
        ii = 35,
        jj = 36,
        DK = 888,
        Refuse = 999
      ),
      class = c("haven_labelled",
                "vctrs_vctr", "double")
    ),
    q0410i_ss = structure(
      c(
        24,
        2,
        9,
        1,
        999,
        999,
        999,
        2,
        999,
        888,
        888,
        13,
        20,
        NA,
        23,
        888,
        13,
        999,
        999,
        888,
        17,
        12,
        2,
        2,
        2,
        999,
        22,
        999,
        2,
        2,
        3,
        888,
        18,
        1,
        888,
        999,
        2,
        999,
        2,
        2,
        999,
        23,
        9,
        15,
        10,
        1,
        888,
        21,
        2,
        25,
        2,
        888,
        999,
        999,
        14,
        999,
        1,
        1,
        2,
        17,
        2,
        999,
        17,
        999,
        1,
        17,
        2,
        17,
        2,
        10,
        2,
        12,
        2,
        2,
        999,
        999,
        999,
        2,
        10,
        1,
        2,
        999,
        13,
        13,
        12,
        999,
        999,
        24,
        2,
        888,
        999,
        2,
        4,
        NA,
        2,
        2,
        17,
        999,
        7,
        2,
        1,
        26,
        999,
        2,
        8,
        2,
        999,
        2,
        23,
        2,
        19,
        11,
        999,
        999,
        2,
        999,
        11,
        999,
        2,
        999,
        999,
        999,
        16,
        999,
        2,
        999,
        17,
        2,
        1,
        999,
        21,
        17,
        26,
        15,
        20,
        NA,
        1,
        888,
        999,
        1,
        17,
        999,
        9,
        23,
        24,
        2,
        1,
        2,
        999,
        NA,
        999,
        16,
        18,
        999,
        19,
        1,
        2,
        1,
        2,
        999,
        1,
        21,
        888,
        2,
        1,
        888,
        21,
        999,
        2,
        24,
        999,
        999,
        14,
        2,
        2,
        2,
        2,
        12,
        16,
        10,
        999,
        23,
        2,
        888,
        2,
        2,
        888,
        26,
        1,
        2,
        999,
        17,
        12,
        1,
        8,
        12,
        2,
        999,
        999,
        15,
        2,
        999,
        9,
        999,
        19,
        NA,
        NA,
        18,
        15,
        27,
        NA,
        999,
        888,
        999,
        23,
        20,
        2,
        999,
        2,
        888,
        2,
        2,
        2,
        1,
        24,
        2,
        1,
        999,
        888,
        999,
        1,
        23,
        10,
        1,
        2,
        19,
        23,
        2,
        999,
        20,
        999,
        888,
        2,
        1,
        2,
        999,
        888,
        999,
        11,
        2,
        20,
        20,
        1,
        999,
        999,
        999,
        999,
        NA,
        14,
        1,
        999,
        2,
        2,
        17,
        999,
        999,
        999,
        999,
        15,
        2,
        1,
        2,
        22,
        15,
        2,
        1,
        2,
        999,
        1,
        2,
        12,
        999,
        13,
        2,
        999,
        15,
        13,
        20,
        888,
        2,
        1,
        999,
        2,
        12,
        888,
        2,
        2,
        999,
        2,
        2,
        NA,
        888,
        21,
        28,
        2,
        999,
        2,
        2,
        1,
        888,
        1,
        2,
        18,
        23,
        3,
        14,
        999,
        2,
        999,
        999,
        888,
        1,
        888,
        888,
        18,
        23,
        1,
        999,
        999,
        999,
        2,
        1,
        999,
        999,
        2,
        1,
        2,
        NA,
        2,
        NA,
        999,
        999,
        1,
        888,
        17,
        999,
        2,
        18,
        23,
        10,
        888,
        999,
        999,
        999,
        1,
        888,
        2,
        888,
        999,
        1,
        999,
        2,
        999,
        999,
        25,
        21,
        999,
        21,
        19,
        999,
        10,
        2,
        999,
        22,
        1,
        888,
        2,
        999,
        888,
        8,
        2,
        2,
        17,
        22,
        999,
        17,
        7,
        999,
        24,
        19,
        999,
        999,
        999,
        11,
        2,
        999,
        12,
        1,
        24,
        888,
        1,
        12,
        1,
        3,
        2,
        2,
        999,
        2,
        4,
        1,
        15,
        23,
        15,
        999,
        2,
        1,
        21,
        2,
        15,
        17,
        999,
        2,
        999,
        1,
        888,
        13,
        1,
        8,
        999,
        NA,
        2,
        2,
        888,
        1,
        999,
        2,
        NA,
        888,
        2,
        999,
        999,
        14,
        888,
        1,
        18,
        2,
        888,
        2,
        4,
        999,
        2,
        1,
        999,
        999,
        3,
        13,
        14,
        999,
        999,
        999,
        999,
        999,
        999,
        999,
        2,
        888,
        2,
        10,
        999,
        999,
        2,
        2,
        1,
        999,
        999,
        18,
        NA,
        1,
        999,
        2,
        999,
        999,
        1,
        888,
        2,
        888,
        999,
        24,
        888,
        17,
        999,
        999,
        2,
        23,
        999,
        999,
        17,
        999,
        999,
        999,
        1,
        2,
        20,
        2,
        NA,
        888,
        23,
        2,
        15,
        8,
        999,
        999,
        999,
        999,
        NA,
        888,
        2,
        2,
        999,
        NA,
        20,
        999,
        NA,
        999,
        999,
        2,
        888,
        2,
        2,
        19,
        2,
        888,
        16,
        999,
        18,
        16,
        17,
        999,
        999,
        15,
        999,
        999,
        2,
        999,
        888,
        25,
        NA,
        2,
        17,
        19,
        9,
        1,
        999,
        2,
        999,
        999,
        888,
        2,
        NA,
        2,
        2,
        999,
        5,
        17,
        18,
        999,
        999,
        9,
        14,
        18,
        23,
        2,
        26,
        2,
        1,
        999,
        24,
        1,
        1,
        999,
        2,
        2,
        1,
        7,
        10,
        888,
        15,
        999,
        18,
        23,
        999,
        23,
        2,
        999,
        1,
        2,
        2,
        2,
        2,
        888,
        999,
        2,
        999,
        2,
        14,
        999,
        999,
        888,
        999,
        18,
        23,
        1,
        2,
        17,
        2,
        999,
        1,
        18,
        888,
        2,
        2,
        1,
        1,
        999,
        999,
        10,
        11,
        25,
        1,
        999,
        12,
        2,
        999,
        17,
        999,
        2,
        999,
        23,
        2,
        999,
        14,
        17,
        24,
        888,
        1,
        22,
        888,
        24,
        1,
        24,
        999,
        17,
        22,
        12,
        2,
        999,
        2,
        999,
        888,
        NA,
        1,
        9,
        2,
        11,
        10,
        16,
        888,
        2,
        999,
        1,
        888,
        3,
        888,
        2,
        12,
        2,
        2,
        999,
        2,
        2,
        9,
        999,
        999,
        999,
        NA,
        2,
        888,
        10,
        999,
        999,
        999,
        2,
        24,
        2,
        999,
        18,
        999,
        2,
        999,
        NA,
        888,
        21,
        999,
        18,
        1,
        17,
        999,
        999,
        4,
        1,
        26,
        2,
        2,
        20,
        888,
        999,
        888,
        999,
        999,
        23,
        9,
        2,
        11,
        15,
        15,
        1,
        17,
        2,
        888,
        18,
        2,
        17,
        1,
        999,
        999,
        2,
        NA,
        2,
        1,
        999,
        999,
        2,
        888,
        22,
        14,
        1,
        19,
        2,
        999,
        999,
        16,
        1,
        18,
        20,
        14,
        NA,
        999,
        999,
        999,
        999,
        888,
        1,
        999,
        999,
        2,
        20,
        999,
        23,
        NA,
        1,
        11,
        999,
        999,
        2,
        13,
        2,
        999,
        2,
        888,
        999,
        19,
        999,
        2,
        2,
        2,
        999,
        14,
        999,
        999,
        2,
        15,
        888,
        2,
        1,
        999,
        999,
        888,
        18,
        1,
        888,
        2,
        999,
        999,
        13,
        999,
        999,
        1,
        2,
        999,
        999,
        888,
        999,
        12,
        5,
        2,
        999,
        999,
        999,
        NA,
        1,
        1,
        1,
        2,
        999,
        15,
        15,
        1,
        2,
        999,
        999,
        NA,
        999,
        NA,
        999,
        NA,
        999,
        23,
        888,
        2,
        1,
        24,
        999,
        999,
        15,
        19,
        999,
        1,
        9,
        1,
        2,
        8,
        1,
        24,
        2,
        22,
        14,
        999,
        2,
        999,
        888,
        2,
        12,
        15,
        999,
        2,
        2,
        999,
        21,
        2,
        24,
        15,
        2,
        999,
        NA,
        2,
        2,
        888,
        999,
        999,
        2,
        NA,
        2,
        4,
        16,
        2,
        888,
        17,
        12,
        1,
        999,
        9,
        1,
        8,
        2,
        2,
        888,
        999,
        888,
        999,
        999
      ),
      label = "income from social security",
      format.stata = "%10.0g",
      labels = c(
        a = 1,
        b = 2,
        c = 3,
        d = 4,
        e = 5,
        f = 6,
        g = 7,
        h = 8,
        i = 9,
        j = 10,
        k = 11,
        l = 12,
        m = 13,
        n = 14,
        o = 15,
        p = 16,
        q = 17,
        r = 18,
        s = 19,
        t = 20,
        u = 21,
        v = 22,
        w = 23,
        x = 24,
        y = 25,
        z = 26,
        aa = 27,
        bb = 28,
        cc = 29,
        dd = 30,
        ee = 31,
        ff = 32,
        gg = 33,
        hh = 34,
        ii = 35,
        jj = 36,
        DK = 888,
        Refuse = 999
      ),
      class = c("haven_labelled",
                "vctrs_vctr", "double")
    ),
    q0410j_government = structure(
      c(
        2,
        2,
        1,
        1,
        999,
        999,
        999,
        2,
        999,
        888,
        2,
        2,
        2,
        NA,
        1,
        999,
        2,
        999,
        1,
        888,
        1,
        1,
        999,
        2,
        2,
        999,
        1,
        999,
        2,
        2,
        3,
        888,
        2,
        1,
        888,
        999,
        16,
        2,
        2,
        2,
        999,
        2,
        1,
        1,
        1,
        1,
        888,
        1,
        2,
        1,
        2,
        888,
        999,
        999,
        2,
        999,
        1,
        1,
        2,
        1,
        2,
        999,
        1,
        999,
        1,
        2,
        2,
        1,
        2,
        2,
        2,
        1,
        2,
        2,
        999,
        999,
        999,
        21,
        888,
        1,
        23,
        2,
        13,
        1,
        1,
        999,
        999,
        1,
        999,
        888,
        999,
        2,
        2,
        NA,
        2,
        13,
        1,
        999,
        2,
        2,
        1,
        1,
        999,
        2,
        999,
        2,
        999,
        2,
        2,
        2,
        2,
        7,
        999,
        999,
        2,
        999,
        1,
        999,
        9,
        999,
        999,
        999,
        1,
        999,
        8,
        999,
        1,
        2,
        1,
        999,
        2,
        2,
        1,
        2,
        20,
        NA,
        1,
        888,
        999,
        1,
        2,
        999,
        1,
        1,
        2,
        2,
        1,
        2,
        2,
        NA,
        999,
        1,
        1,
        999,
        1,
        8,
        2,
        1,
        2,
        999,
        1,
        2,
        2,
        12,
        1,
        888,
        1,
        999,
        2,
        2,
        999,
        999,
        2,
        8,
        2,
        2,
        2,
        1,
        2,
        1,
        999,
        1,
        4,
        888,
        2,
        2,
        888,
        2,
        1,
        2,
        999,
        1,
        2,
        1,
        1,
        1,
        2,
        999,
        999,
        2,
        8,
        999,
        11,
        999,
        2,
        NA,
        NA,
        2,
        1,
        1,
        NA,
        999,
        888,
        999,
        2,
        2,
        2,
        999,
        2,
        888,
        2,
        2,
        2,
        2,
        2,
        4,
        1,
        999,
        999,
        999,
        1,
        2,
        7,
        1,
        2,
        2,
        2,
        2,
        2,
        1,
        999,
        888,
        11,
        1,
        2,
        999,
        2,
        999,
        2,
        2,
        2,
        2,
        1,
        1,
        999,
        999,
        999,
        NA,
        1,
        1,
        999,
        2,
        2,
        1,
        999,
        999,
        999,
        2,
        2,
        2,
        1,
        2,
        2,
        2,
        2,
        1,
        2,
        999,
        1,
        2,
        1,
        999,
        1,
        2,
        999,
        1,
        2,
        1,
        888,
        2,
        1,
        999,
        2,
        2,
        2,
        2,
        2,
        999,
        9,
        2,
        NA,
        888,
        2,
        2,
        2,
        999,
        2,
        12,
        7,
        999,
        15,
        2,
        1,
        2,
        3,
        1,
        999,
        2,
        999,
        999,
        2,
        1,
        888,
        888,
        2,
        2,
        1,
        999,
        2,
        999,
        2,
        1,
        999,
        999,
        2,
        1,
        25,
        NA,
        14,
        NA,
        999,
        888,
        1,
        888,
        1,
        999,
        5,
        2,
        2,
        1,
        888,
        2,
        999,
        999,
        1,
        2,
        2,
        888,
        1,
        1,
        888,
        2,
        999,
        999,
        1,
        1,
        999,
        2,
        1,
        999,
        1,
        888,
        999,
        1,
        8,
        888,
        2,
        2,
        2,
        2,
        2,
        2,
        999,
        1,
        2,
        1,
        1,
        999,
        2,
        2,
        999,
        999,
        999,
        12,
        2,
        2,
        2,
        1,
        2,
        999,
        1,
        2,
        7,
        2,
        2,
        4,
        999,
        2,
        2,
        1,
        2,
        1,
        2,
        999,
        1,
        1,
        2,
        2,
        2,
        999,
        999,
        2,
        999,
        1,
        1,
        888,
        1,
        2,
        999,
        NA,
        2,
        2,
        888,
        1,
        999,
        2,
        NA,
        888,
        13,
        2,
        999,
        1,
        888,
        7,
        1,
        2,
        888,
        16,
        2,
        999,
        2,
        1,
        999,
        999,
        3,
        13,
        1,
        999,
        2,
        999,
        2,
        999,
        999,
        2,
        2,
        888,
        3,
        1,
        999,
        999,
        2,
        2,
        9,
        999,
        999,
        2,
        NA,
        1,
        999,
        2,
        999,
        999,
        1,
        888,
        9,
        888,
        999,
        1,
        888,
        1,
        999,
        999,
        2,
        2,
        999,
        999,
        1,
        999,
        888,
        999,
        1,
        11,
        1,
        5,
        NA,
        888,
        1,
        2,
        2,
        11,
        999,
        999,
        999,
        999,
        NA,
        888,
        2,
        2,
        999,
        NA,
        1,
        999,
        NA,
        999,
        999,
        2,
        888,
        9,
        2,
        2,
        2,
        888,
        2,
        999,
        1,
        2,
        2,
        999,
        2,
        1,
        999,
        999,
        2,
        999,
        888,
        1,
        NA,
        2,
        1,
        888,
        7,
        1,
        999,
        2,
        999,
        2,
        888,
        2,
        NA,
        2,
        2,
        999,
        1,
        2,
        1,
        999,
        999,
        1,
        1,
        1,
        1,
        2,
        2,
        888,
        1,
        999,
        2,
        1,
        1,
        999,
        2,
        2,
        1,
        1,
        2,
        888,
        1,
        999,
        1,
        2,
        999,
        1,
        2,
        999,
        1,
        2,
        12,
        2,
        18,
        888,
        999,
        2,
        999,
        2,
        1,
        999,
        999,
        888,
        999,
        2,
        2,
        1,
        2,
        1,
        2,
        999,
        1,
        1,
        888,
        14,
        2,
        1,
        1,
        999,
        999,
        1,
        1,
        2,
        1,
        999,
        4,
        2,
        999,
        2,
        2,
        2,
        999,
        2,
        2,
        999,
        14,
        1,
        2,
        2,
        1,
        2,
        999,
        2,
        1,
        1,
        999,
        1,
        9,
        1,
        999,
        999,
        2,
        3,
        888,
        NA,
        1,
        2,
        10,
        1,
        1,
        999,
        2,
        2,
        999,
        1,
        888,
        2,
        888,
        2,
        1,
        2,
        2,
        999,
        22,
        2,
        15,
        999,
        999,
        999,
        NA,
        2,
        2,
        1,
        999,
        999,
        999,
        5,
        1,
        2,
        999,
        2,
        888,
        2,
        999,
        NA,
        999,
        2,
        999,
        1,
        1,
        1,
        999,
        999,
        999,
        12,
        2,
        2,
        2,
        1,
        888,
        999,
        888,
        999,
        999,
        2,
        2,
        13,
        2,
        2,
        1,
        1,
        1,
        2,
        888,
        2,
        2,
        1,
        7,
        999,
        2,
        2,
        NA,
        2,
        1,
        999,
        999,
        2,
        1,
        2,
        2,
        1,
        2,
        15,
        999,
        999,
        1,
        1,
        1,
        2,
        2,
        NA,
        2,
        999,
        999,
        999,
        2,
        1,
        999,
        999,
        2,
        1,
        999,
        2,
        NA,
        1,
        2,
        2,
        999,
        2,
        1,
        2,
        999,
        2,
        999,
        999,
        2,
        999,
        2,
        2,
        2,
        999,
        1,
        999,
        2,
        2,
        8,
        888,
        2,
        1,
        999,
        999,
        888,
        1,
        1,
        2,
        2,
        999,
        2,
        2,
        999,
        999,
        1,
        2,
        999,
        999,
        888,
        999,
        2,
        1,
        4,
        999,
        999,
        999,
        NA,
        1,
        1,
        17,
        2,
        999,
        1,
        1,
        1,
        2,
        2,
        999,
        NA,
        999,
        NA,
        2,
        NA,
        999,
        2,
        888,
        2,
        1,
        2,
        999,
        999,
        2,
        1,
        999,
        1,
        1,
        1,
        2,
        2,
        1,
        2,
        12,
        2,
        2,
        999,
        2,
        2,
        999,
        2,
        12,
        1,
        999,
        2,
        2,
        999,
        2,
        2,
        2,
        2,
        2,
        999,
        NA,
        2,
        2,
        888,
        999,
        999,
        2,
        NA,
        2,
        4,
        1,
        2,
        1,
        1,
        1,
        1,
        999,
        2,
        1,
        2,
        2,
        2,
        888,
        999,
        888,
        999,
        2
      ),
      label = "income from government assistance",
      format.stata = "%10.0g",
      labels = c(
        a = 1,
        b = 2,
        c = 3,
        d = 4,
        e = 5,
        f = 6,
        g = 7,
        h = 8,
        i = 9,
        j = 10,
        k = 11,
        l = 12,
        m = 13,
        n = 14,
        o = 15,
        p = 16,
        q = 17,
        r = 18,
        s = 19,
        t = 20,
        u = 21,
        v = 22,
        w = 23,
        x = 24,
        y = 25,
        z = 26,
        aa = 27,
        bb = 28,
        cc = 29,
        dd = 30,
        ee = 31,
        ff = 32,
        gg = 33,
        hh = 34,
        ii = 35,
        jj = 36,
        DK = 888,
        Refuse = 999
      ),
      class = c("haven_labelled",
                "vctrs_vctr", "double")
    ),
    q0410k_other = structure(
      c(
        2,
        999,
        1,
        1,
        999,
        999,
        999,
        2,
        999,
        888,
        888,
        2,
        2,
        NA,
        1,
        999,
        2,
        999,
        1,
        888,
        1,
        1,
        999,
        2,
        2,
        999,
        1,
        999,
        999,
        2,
        3,
        888,
        2,
        1,
        888,
        999,
        2,
        2,
        2,
        2,
        999,
        2,
        1,
        1,
        1,
        1,
        888,
        1,
        2,
        1,
        2,
        888,
        999,
        999,
        2,
        999,
        1,
        1,
        8,
        1,
        2,
        999,
        1,
        999,
        1,
        2,
        2,
        1,
        2,
        2,
        2,
        1,
        2,
        2,
        999,
        999,
        999,
        2,
        10,
        1,
        2,
        999,
        13,
        1,
        1,
        999,
        999,
        1,
        888,
        888,
        999,
        2,
        2,
        NA,
        2,
        2,
        1,
        999,
        2,
        2,
        1,
        1,
        999,
        18,
        999,
        2,
        999,
        20,
        2,
        2,
        2,
        2,
        999,
        999,
        2,
        999,
        1,
        999,
        2,
        999,
        999,
        999,
        1,
        999,
        2,
        999,
        1,
        2,
        1,
        999,
        2,
        2,
        1,
        2,
        1,
        NA,
        1,
        888,
        999,
        1,
        2,
        999,
        1,
        1,
        23,
        2,
        1,
        2,
        999,
        NA,
        999,
        1,
        1,
        999,
        1,
        1,
        2,
        1,
        2,
        999,
        1,
        2,
        2,
        2,
        1,
        888,
        1,
        888,
        2,
        2,
        999,
        999,
        2,
        2,
        9,
        2,
        2,
        1,
        2,
        8,
        999,
        1,
        2,
        888,
        2,
        2,
        888,
        2,
        1,
        2,
        888,
        1,
        2,
        888,
        1,
        1,
        2,
        999,
        999,
        2,
        2,
        888,
        2,
        999,
        2,
        NA,
        NA,
        2,
        1,
        1,
        NA,
        999,
        888,
        888,
        2,
        2,
        2,
        999,
        2,
        888,
        2,
        2,
        2,
        2,
        2,
        2,
        1,
        999,
        888,
        999,
        1,
        2,
        4,
        1,
        2,
        2,
        2,
        2,
        2,
        1,
        999,
        888,
        2,
        1,
        2,
        999,
        2,
        999,
        2,
        2,
        2,
        2,
        1,
        999,
        999,
        888,
        888,
        NA,
        1,
        1,
        999,
        2,
        2,
        1,
        999,
        999,
        888,
        2,
        2,
        2,
        1,
        888,
        2,
        23,
        888,
        1,
        2,
        999,
        1,
        4,
        1,
        999,
        1,
        2,
        999,
        13,
        2,
        1,
        888,
        2,
        1,
        999,
        2,
        2,
        2,
        2,
        2,
        999,
        2,
        2,
        NA,
        888,
        2,
        2,
        2,
        999,
        2,
        2,
        1,
        888,
        1,
        2,
        2,
        2,
        999,
        1,
        999,
        2,
        999,
        999,
        2,
        1,
        888,
        888,
        2,
        2,
        1,
        999,
        2,
        999,
        2,
        1,
        999,
        999,
        2,
        1,
        2,
        NA,
        2,
        NA,
        999,
        999,
        1,
        888,
        1,
        999,
        2,
        2,
        2,
        1,
        888,
        2,
        999,
        999,
        1,
        888,
        2,
        888,
        1,
        1,
        999,
        2,
        999,
        999,
        1,
        1,
        999,
        2,
        1,
        999,
        1,
        2,
        999,
        1,
        1,
        888,
        2,
        2,
        2,
        2,
        2,
        2,
        888,
        1,
        2,
        1,
        1,
        999,
        2,
        2,
        999,
        999,
        999,
        2,
        2,
        2,
        2,
        1,
        2,
        888,
        1,
        2,
        1,
        2,
        2,
        2,
        999,
        2,
        2,
        1,
        2,
        1,
        2,
        999,
        2,
        1,
        2,
        2,
        2,
        999,
        999,
        2,
        999,
        1,
        1,
        888,
        1,
        2,
        999,
        NA,
        2,
        2,
        888,
        1,
        999,
        2,
        NA,
        888,
        2,
        2,
        999,
        1,
        888,
        1,
        1,
        999,
        888,
        2,
        2,
        999,
        2,
        1,
        999,
        999,
        2,
        1,
        1,
        999,
        2,
        888,
        2,
        999,
        999,
        2,
        2,
        888,
        2,
        1,
        888,
        999,
        2,
        2,
        1,
        999,
        999,
        2,
        NA,
        1,
        999,
        2,
        999,
        999,
        1,
        888,
        2,
        888,
        999,
        1,
        888,
        1,
        999,
        999,
        15,
        2,
        999,
        999,
        1,
        999,
        888,
        999,
        1,
        2,
        1,
        999,
        NA,
        888,
        1,
        2,
        2,
        2,
        999,
        999,
        999,
        888,
        NA,
        888,
        2,
        2,
        999,
        NA,
        1,
        999,
        NA,
        999,
        999,
        2,
        888,
        2,
        2,
        2,
        2,
        888,
        2,
        999,
        1,
        2,
        2,
        999,
        999,
        1,
        999,
        999,
        2,
        999,
        888,
        1,
        NA,
        18,
        1,
        2,
        1,
        1,
        999,
        2,
        888,
        18,
        888,
        2,
        NA,
        2,
        2,
        999,
        1,
        2,
        1,
        999,
        999,
        1,
        14,
        1,
        1,
        888,
        9,
        2,
        1,
        999,
        2,
        1,
        1,
        999,
        2,
        2,
        1,
        1,
        2,
        888,
        1,
        999,
        1,
        2,
        999,
        1,
        2,
        999,
        1,
        2,
        2,
        2,
        2,
        888,
        999,
        2,
        999,
        2,
        1,
        999,
        888,
        888,
        999,
        2,
        2,
        1,
        2,
        1,
        2,
        999,
        1,
        1,
        888,
        2,
        2,
        1,
        1,
        999,
        999,
        1,
        1,
        2,
        1,
        888,
        2,
        2,
        999,
        2,
        2,
        2,
        999,
        2,
        2,
        999,
        2,
        1,
        2,
        2,
        1,
        2,
        2,
        2,
        1,
        1,
        999,
        1,
        2,
        1,
        999,
        999,
        2,
        999,
        888,
        NA,
        1,
        2,
        2,
        1,
        1,
        999,
        888,
        2,
        999,
        1,
        888,
        2,
        888,
        2,
        1,
        2,
        2,
        999,
        2,
        4,
        2,
        999,
        999,
        999,
        NA,
        2,
        2,
        1,
        999,
        2,
        999,
        2,
        1,
        2,
        999,
        2,
        888,
        2,
        999,
        NA,
        888,
        2,
        999,
        1,
        1,
        888,
        999,
        999,
        999,
        1,
        30,
        2,
        2,
        1,
        888,
        999,
        888,
        999,
        999,
        2,
        2,
        2,
        2,
        2,
        1,
        1,
        1,
        2,
        888,
        1,
        2,
        1,
        1,
        999,
        999,
        2,
        NA,
        26,
        1,
        999,
        999,
        2,
        888,
        2,
        2,
        1,
        2,
        2,
        999,
        999,
        1,
        1,
        1,
        2,
        2,
        NA,
        2,
        888,
        888,
        999,
        2,
        1,
        999,
        999,
        2,
        1,
        999,
        2,
        NA,
        1,
        2,
        2,
        999,
        2,
        1,
        2,
        999,
        2,
        999,
        999,
        2,
        2,
        2,
        2,
        2,
        999,
        1,
        999,
        999,
        2,
        2,
        888,
        2,
        1,
        999,
        1,
        888,
        1,
        1,
        2,
        2,
        888,
        2,
        2,
        999,
        999,
        1,
        888,
        999,
        1,
        888,
        999,
        2,
        1,
        2,
        999,
        999,
        999,
        NA,
        1,
        1,
        1,
        2,
        999,
        1,
        1,
        1,
        2,
        2,
        999,
        NA,
        999,
        NA,
        2,
        NA,
        999,
        2,
        888,
        2,
        1,
        2,
        999,
        888,
        2,
        1,
        999,
        1,
        1,
        1,
        2,
        2,
        1,
        2,
        2,
        2,
        2,
        999,
        11,
        2,
        999,
        2,
        1,
        1,
        999,
        2,
        2,
        999,
        2,
        2,
        23,
        2,
        2,
        999,
        NA,
        2,
        2,
        888,
        999,
        999,
        2,
        NA,
        2,
        999,
        1,
        2,
        1,
        1,
        1,
        1,
        999,
        2,
        1,
        10,
        2,
        2,
        888,
        999,
        888,
        999,
        999
      ),
      label = "income from other sources",
      format.stata = "%10.0g",
      labels = c(
        a = 1,
        b = 2,
        c = 3,
        d = 4,
        e = 5,
        f = 6,
        g = 7,
        h = 8,
        i = 9,
        j = 10,
        k = 11,
        l = 12,
        m = 13,
        n = 14,
        o = 15,
        p = 16,
        q = 17,
        r = 18,
        s = 19,
        t = 20,
        u = 21,
        v = 22,
        w = 23,
        x = 24,
        y = 25,
        z = 26,
        aa = 27,
        bb = 28,
        cc = 29,
        dd = 30,
        ee = 31,
        ff = 32,
        gg = 33,
        hh = 34,
        ii = 35,
        jj = 36,
        DK = 888,
        Refuse = 999
      ),
      class = c("haven_labelled",
                "vctrs_vctr", "double")
    )
  ),
  row.names = c(NA,-900L),
  class = c("tbl_df",
            "tbl", "data.frame")
)



# Problem description
#We need to calculate the centiles for the baseline sample. 
#The approach we follow is to sum all the variables that collect data on income: 
#   
#   -   `q0410g_total`: gross personal income of all members of your family during 
# the last 12M.
# -   `q0410i_ss`: gross household income during the last 12M from the retirement 
# pension.
# -   `q0410j_government`: gross household income (...) from official programs 
# (unemployment, dependent children, widows, widowers, orphans, 
#   general assistance, ...).
# -   `q0410k_other`: from private sources (pensions, investments, alimony or 
#                                           maintenance).
# 
# We encountered two problems:
#   - The characteristics of the double format of database variables in Stata make 
# it necessary to do some previous transformations to be able to handle it
# properly.
# - The NAs for each variable result in a number of NAs different 
# from the number of NAs for each of these variables separately.
# - When converting to NAs, an error occurs that I cannot locate. 


### Variable exploration

 
data_c2019w1 |> 
  transmute(across(q0410g_total:q0410k_other, is.na)) |> 
  distinct()
 
#The number of NAs in these variables is the same (91 as proxy respondents).

 
data_c2019w1 %>% 
  freq_table(q0410g_total) %>% 
  print(n = 50)
 

 
data_c2019w1  %>% 
  freq_table(q0410i_ss) %>% 
  print(n = 50)
 

 
data_c2019w1  %>% 
  freq_table(q0410j_government) %>% 
  print(n = 50)
 

 
data_c2019w1  %>% 
  freq_table(q0410k_other) %>% 
  print(n = 50)
 

#### Variable recoding

# These variables are originally factor variables with a value of a number from
# 1 to 33 and a label indicating the median value of the established range. 
# 
# We have, therefore, to convert these factor variables into numeric variables 
# whose values are the information of the median of the established range 
# (currently they are there as labels). To do this, we will:
#   
#   * recode them into the respective medians,
# * change their format,
# * change the value of the NAs to what was agreed in RESPOND, 
# * convert the missing values into NAs in order to be able to do the sum, 
# * sum 
# * and divide by quintiles and convert the NAs into their original values. 


 
data_c2019w1 <- 
  data_c2019w1 %>% 
  mutate(q0410g_total_r = recode_factor(q0410g_total,
                                        "999" = REFUSED_ANSWER,
                                        "888" = NON_RESPONSE,
                                        "1"  =           0, "2"  =      0, "3"  =    500, "4"  =    1500,
                                        "5"  =        2500, "6"  =   3500, "7"  =   4500, "8"  =    5500,
                                        "9"  =        6500, "10" =   7500, "11" =   8500, "12" =    9500,
                                        "13" =       10500, "14" =  11500, "15" =  12500, "16" =   13500,
                                        "17" =       14500, "18" =  15500, "19" =  16500, "20" =   17500,
                                        "21" =       18500, "22" =  19500, "23" =  22500, "24" =   27500,
                                        "25" =       32500, "26" =  37500, "27" =  42500, "28" =   47500,
                                        "29" =       62500, "30" =  87500, "31" = 125000, "32" =  175500,
                                        "33" =      250000, "34" = 400000, "35" = 750000, "36" = 1000000),
         
         q0410i_ss_r = recode_factor(q0410i_ss,
                                     "999" = REFUSED_ANSWER,
                                     "888" = NON_RESPONSE,
                                     "1"  =           0, "2"  =      0, "3"  =    500, "4"  =    1500,
                                     "5"  =        2500, "6"  =   3500, "7"  =   4500, "8"  =    5500,
                                     "9"  =        6500, "10" =   7500, "11" =   8500, "12" =    9500,
                                     "13" =       10500, "14" =  11500, "15" =  12500, "16" =   13500,
                                     "17" =       14500, "18" =  15500, "19" =  16500, "20" =   17500,
                                     "21" =       18500, "22" =  19500, "23" =  22500, "24" =   27500,
                                     "25" =       32500, "26" =  37500, "27" =  42500, "28" =   47500,
                                     "29" =       62500, "30" =  87500, "31" = 125000, "32" =  175500,
                                     "33" =      250000, "34" = 400000, "35" = 750000, "36" = 1000000),
         q0410j_government_r = recode_factor(q0410j_government,
                                             "999" = REFUSED_ANSWER,
                                             "888" = NON_RESPONSE,
                                             "1"  =           0, "2"  =      0, "3"  =    500, "4"  =    1500,
                                             "5"  =        2500, "6"  =   3500, "7"  =   4500, "8"  =    5500,
                                             "9"  =        6500, "10" =   7500, "11" =   8500, "12" =    9500,
                                             "13" =       10500, "14" =  11500, "15" =  12500, "16" =   13500,
                                             "17" =       14500, "18" =  15500, "19" =  16500, "20" =   17500,
                                             "21" =       18500, "22" =  19500, "23" =  22500, "24" =   27500,
                                             "25" =       32500, "26" =  37500, "27" =  42500, "28" =   47500,
                                             "29" =       62500, "30" =  87500, "31" = 125000, "32" =  175500,
                                             "33" =      250000, "34" = 400000, "35" = 750000, "36" = 1000000),
         q0410k_other_r = recode_factor(q0410k_other,
                                        "999" = REFUSED_ANSWER,
                                        "888" = NON_RESPONSE, 
                                        "1"  =           0, "2"  =      0, "3"  =    500, "4"  =    1500,
                                        "5"  =        2500, "6"  =   3500, "7"  =   4500, "8"  =    5500,
                                        "9"  =        6500, "10" =   7500, "11" =   8500, "12" =    9500,
                                        "13" =       10500, "14" =  11500, "15" =  12500, "16" =   13500,
                                        "17" =       14500, "18" =  15500, "19" =  16500, "20" =   17500,
                                        "21" =       18500, "22" =  19500, "23" =  22500, "24" =   27500,
                                        "25" =       32500, "26" =  37500, "27" =  42500, "28" =   47500,
                                        "29" =       62500, "30" =  87500, "31" = 125000, "32" =  175500,
                                        "33" =      250000, "34" = 400000, "35" = 750000, "36" = 1000000)
  )
 

 
data_c2019w1 %>% 
  select(q0410g_total,  
         q0410g_total_r, 
         q0410i_ss, 
         q0410i_ss_r, 
         q0410j_government, 
         q0410j_government_r, 
         q0410k_other,
         q0410k_other_r) %>% 
  str()
 

 
data_c2019w1 %>% 
  select(q0410g_total, q0410g_total_r) %>% 
  View()
 

# After this coding we see that the levels have been modified, but not the labels.
# We convert first to character and then to integer:
  
   
data_c2019w1 <- 
  data_c2019w1 %>% 
  mutate(
    q0410g_total_r = as.character(q0410g_total_r),
    q0410i_ss_r = as.character(q0410i_ss_r),
    q0410j_government_r = as.character(q0410j_government_r),
    q0410k_other_r = as.character(q0410k_other_r),
    
    q0410g_total_r = as.integer(q0410g_total_r),
    q0410i_ss_r = as.integer(q0410i_ss_r),
    q0410j_government_r = as.integer(q0410j_government_r),
    q0410k_other_r = as.integer(q0410k_other_r)
  )
 

 
g1 <- ggplot(data_c2019w1) +
  geom_bar(mapping = aes(x = q0410g_total_r))

g2 <- ggplot(data_c2019w1) +
  geom_bar(mapping = aes(x = q0410i_ss_r))

g3 <- ggplot(data_c2019w1 ) +
  geom_bar(mapping = aes(x = q0410j_government_r))


g4 <- ggplot(data_c2019w1 ) +
  geom_bar(mapping = aes(x = q0410k_other_r))

grid.arrange(g1, g2, g3, g4)
 

#We check that the NAs are well coded (-993 and NA).
 
data_c2019w1 %>%
  select(q0410g_total_r, q0410i_ss_r, q0410j_government_r, q0410k_other_r) %>%
  summarise_all(funs(sum(is.na(.)))) #NAs fine: 91 as proxy

 
data_c2019w1 %>% 
  freq_table(q0410g_total_r) %>%  # 371 + 819 = 1190 NON_RESPONSE
  print(n = 26)
 

 
data_c2019w1 %>% 
  freq_table(q0410i_ss_r) #267 + 824 = 1091 NON_RESPONSE
 

 
data_c2019w1 %>% 
  freq_table(q0410j_government_r) #230 + 766 = 966 NON_RESPONSE
 

 
data_c2019w1   %>% 
  freq_table(q0410k_other_r) #291 + 710 = 1001 NON_RESPONSE
 
# 
# We need to create another variable from this one taking into account the -993 &
# -93 with missing so that they are not taken into account when calculating the 
# quintiles, using na_if().
#  
data_c2019w1 <- 
  data_c2019w1 %>% 
  mutate(
    q0410g_tot_NA = na_if(q0410g_total_r, NON_RESPONSE),
    q0410g_tot_NA = na_if(q0410g_total_r, REFUSED_ANSWER),
    q0410i_ss_NA = na_if(q0410i_ss_r, NON_RESPONSE),
    q0410i_ss_NA = na_if(q0410i_ss_r, REFUSED_ANSWER),
    q0410j_gov_NA = na_if(q0410j_government_r, NON_RESPONSE),
    q0410j_gov_NA = na_if(q0410j_government_r, REFUSED_ANSWER),
    q0410k_other_NA = na_if(q0410k_other_r, NON_RESPONSE),
    q0410k_other_NA = na_if(q0410k_other_r, REFUSED_ANSWER)
  )
 

 
data_c2019w1 %>% 
  freq_table(q0410i_ss_NA)
 


 
data_c2019w1 %>%
  select(q0410g_tot_NA, q0410i_ss_NA, q0410j_gov_NA, q0410k_other_NA) %>%
  summarise_all(funs(sum(is.na(.))))
#  
# Right now the NAs are MISSING_DESIGN (proxy) and NON_RESPONSE.
# While the proxy are always the same, the NON_RESPONSE are different for 
# each variable.
 
data_c2019w1 |> 
  transmute(across(q0410g_total:q0410k_other, is.na)) |>
  distinct()
 


#### Variable creation

 
data_c2019w1 <- 
  data_c2019w1 %>% 
  mutate(
    hh_income_r_NA = q0410g_tot_NA + q0410i_ss_NA + q0410j_gov_NA + q0410k_other_NA)
 

 
data_c2019w1 %>% 
  freq_table(hh_income_r_NA)
 

#We have 99 NAs, including MISSING_DESIGN and NON_RESPONSE.

 
quartiles19 <- c(9816, 15015, 22024) #EUROSTAT criteria
 

 
data_c2019w1 <- data_c2019w1 %>% 
  mutate(
    hhquartile = case_when(
      hh_income_r_NA <= quartiles19[1] ~ 1,
      hh_income_r_NA > quartiles19[1] & hh_income_r_NA <= quartiles19[2] ~ 2,
      hh_income_r_NA > quartiles19[2] & hh_income_r_NA <= quartiles19[3] ~ 3,
      hh_income_r_NA > quartiles19[3] ~ 4,
      is.na(hh_income_r_NA) & is.na(q0410g_total_r) & 
        is.na(q0410i_ss_r) &
        is.na(q0410j_government_r) &
        is.na(q0410k_other_r)
      ~ MISSING_DESIGN,
      is.na(hh_income_r_NA) ~ NON_RESPONSE),                     
    
    hhquartile = factor(x = hhquartile,
                        levels = c("1", "2", "3", "4", MISSING_DESIGN, NON_RESPONSE),
                        labels = c("first quartile", 
                                   "second quartile", 
                                   "third quartile", 
                                   "fourth quartile", 
                                   "not assessed", 
                                   "missing (default)")))

 

#### Checking new variable

 
data_c2019w1%>% 
  freq_table(hhquartile)
 
